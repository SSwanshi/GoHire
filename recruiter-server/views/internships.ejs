<%- include('layout/header') %>

<% if (successMessage) { %>
    <div id="toast" class="fixed top-5 right-5 bg-green-500 text-white p-3 rounded-md shadow-md mt-20">
        <%= successMessage %>
    </div>
    <script>
        setTimeout(() => {
            document.getElementById("toast").style.display = "none";
        }, 3000);
    </script>
<% } %>

<h2 class="font-bold mt-10 flex justify-center font-sans text-xl">Here is your list of recently added Internships</h2>

<section class="my-10 flex justify-center">
    <div class="w-full max-w-6xl">
        <table class="w-full text-left border-collapse border border-gray-300">
            <thead>
                <tr class="text-gray-700 bg-gray-200">
                    <th class="px-6 py-3 border border-gray-300">Company</th>
                    <th class="px-6 py-3 border border-gray-300">Internship Title</th>
                    <th class="px-6 py-3 border border-gray-300">Stipend (in K)</th>
                    <th class="px-6 py-3 border border-gray-300">Location</th>
                    <th class="px-6 py-3 border border-gray-300">Duration</th>
                    <th class="px-6 py-3 border border-gray-300">Opportunities</th>
                    <th class="px-6 py-3 border border-gray-300">Deadline</th>
                    <th class="px-6 py-3 border border-gray-300 text-center">Action</th>
                    <th class="px-6 py-3 border border-gray-300">Applications</th>
                </tr>
            </thead>
            <tbody>
                <% if (internships.length > 0) { %>
                    <% for (var i = 0; i < internships.length; i++) { %>
                        <tr class="hover:bg-gray-100">
                            <td class="px-6 py-4 border border-gray-300">
                                <% if (internships[i].intCompany && internships[i].intCompany.logoId) { %>
                                    <img src="/recruiter/logo/<%= internships[i].intCompany.logoId %>" 
                                         alt="<%= internships[i].intCompany.companyName %> Logo" 
                                         class="h-10 w-10 rounded-full">
                                <% } else { %>
                                    <p class="text-gray-500">No Logo</p>
                                <% } %>
                            </td>
                            <td class="px-6 py-4 border border-gray-300"><%= internships[i].intTitle %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= internships[i].intStipend %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= internships[i].intLocation %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= internships[i].intDuration %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= internships[i].intPositions %></td>
                            <td class="px-6 py-4 border border-gray-300">
                                <%= new Date(internships[i].intExpiry).toLocaleDateString('en-GB') %>
                              </td>
                              
                            <td class="px-6 py-4 border border-gray-300 flex items-center justify-center gap-4 mt-3">
                                <form action="/recruiter/delete-intern/<%= internships[i]._id %>" method="POST">
                                    <button type="submit" class="bg-red-500 hover:bg-red-800 text-white font-bold py-2 px-4 rounded">
                                        Delete
                                    </button> 
                                </form>
                                <a href="/recruiter/edit-internship/<%= internships[i]._id %>" 
                                    class="bg-green-500 hover:bg-green-800 text-white font-bold py-2 px-4 rounded inline-block text-center">
                                    Edit
                                 </a>
                                 
                            </td>
                            <td class="px-6 py-4 border border-gray-300">
                                <a href="/internapplicants/<%= internships[i]._id %>" 
                                   class="bg-blue-400 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded inline-block text-center">
                                    View Applications
                                </a>
                            </td>
                        </tr>
                    <% } %>
                <% } else { %>
                    <tr>
                        <td colspan="8" class="px-6 py-4 text-center text-gray-500">No internships added yet.</td>
                    </tr>
                <% } %>
                
            </tbody>
            
        </table>
    </div>
</section>

<%- include('layout/footer') %> 