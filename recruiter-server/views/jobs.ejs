<%- include('layout/header') %>

<% if (successMessage) { %>
    <div id="toast" class="fixed top-5 right-5 bg-green-500 text-white p-3 rounded-md shadow-md mt-20">
        <%= successMessage %>
    </div>
    <script> 
        setTimeout(() => {
            document.getElementById("toast").style.display = "none";
        }, 3000);
    </script>
<% } %>

<h2 class="font-bold mt-10 flex justify-center font-sans text-xl">Here is your list of recently added Jobs</h2>

<section class="my-10 flex justify-center">
    <div class="w-full max-w-4xl">
        <table class="w-full text-left border-collapse border border-gray-300">
            <thead>
                <tr class="text-gray-700 bg-gray-200">
                    <th class="px-6 py-3 border border-gray-300">Company</th>
                    <th class="px-6 py-3 border border-gray-300">Job Title</th>
                    <th class="px-4 py-3 border border-gray-300">Salary (In LPA)</th>
                    <th class="px-6 py-3 border border-gray-300">Location</th>
                    <th class="px-6 py-3 border border-gray-300">Positions</th>
                    <th class="px-6 py-3 border border-gray-300">Action</th>
                    <th class="px-6 py-3 border border-gray-300">Applications</th>
                </tr>
            </thead>
            <tbody>
                <% if (jobs.length > 0) { %>
                    <% jobs.forEach(job => { %>
                        <tr class="hover:bg-gray-100">
                            <td class="px-6 py-4 border border-gray-300">
                                <% if (job.jobCompany && job.jobCompany.logoId) { %>
                                    <img src="/recruiter/logo/<%= job.jobCompany.logoId %>" 
                                         alt="<%= job.jobCompany.companyName %> Logo" 
                                         class="h-10 w-10 rounded-full">
                                <% } else { %>
                                    <p class="text-gray-500">No Logo</p>
                                <% } %>
                            </td>

                            <td class="px-6 py-4 border border-gray-300"><%= job.jobTitle %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= job.jobSalary %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= job.jobLocation %></td>
                            <td class="px-6 py-4 border border-gray-300"><%= job.noofPositions %></td>
                
                            <!-- Delete Job -->
                            <td class="px-6 py-4 border border-gray-300">
                                <form action="/recruiter/delete-job/<%= job._id %>" method="POST">
                                    <button type="submit" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                        Delete
                                    </button>
                                </form>
                            </td>
                
                            <!-- View Applications -->
                            <td class="px-6 py-4 border border-gray-300">
                                <form action="/recruiter/applicant-job/<%= job._id %>" method="POST">
                                    <button type="submit" class="bg-blue-400 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                                        View Applications
                                    </button>
                                </form>
                            </td>
                        </tr>
                    <% }) %>
                <% } else { %>
                    <tr>
                        <td colspan="7" class="px-6 py-4 text-center text-gray-500">No jobs added yet.</td>
                    </tr>
                <% } %>
                
                
                
            </tbody>
            
        </table>
    </div>
</section>


<%- include('layout/footer') %>